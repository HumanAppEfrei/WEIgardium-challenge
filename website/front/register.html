<!DOCTYPE html>
<html lang="fr">
<head>
  <!-- Responsive website -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  
  <link href="https://fonts.googleapis.com/css?family=Amatic+SC" rel="stylesheet">
  
  <link rel="stylesheet" href="./css/materialize.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
  <link rel="stylesheet" href="css/style.css">
  
  <title>Challenge WEIGARDIUM - Human'App</title>
</head>
<body>
  <header>
    <div class="navbar-fixed">
      <nav>
        <div class="nav-wrapper teal lighten-1">
          <div class="container">
            <a href="/" class="brand-logo left hide-on-med-and-down"><b>Human'app</b></a>
            
            <a href="/" class="brand-logo center hide-on-large-only"><b>Human'app</b></a>
            
            <ul id="nav-mobile" class="left">
              <li><a href="#"><i class="fas fa-bars"></i></a></li>
            </ul>
          </div>
        </div>
      </nav>
    </div>
  </header>

  
  <main>
    <div class="container">
      <h1 class="center-align">S'inscrire au défi</h1>
    </div>
  
    
    <div class="container row">
      <form action="https://weigardium-challenge.human-app.fr/user" method="post">
        <div class="col s12 m6">
          <label for="first-name-input" id="first-name-label">Prénom</label>
          <input type="text" placeholder="John" id="first-name-input">
        </div>
        
        <div class="col s12 m6">
          <label for="last-name-input" id="last-name-label">Nom de famille</label>
          <input type="text" placeholder="Doe" id="last-name-input">
        </div>
        
        <div class="col s12 m6 push-m3">
          <label for="student-id-input" id="student-id-label">Numéro d'étudiant (20180xxx)</label>
          <input type="number" placeholder="20180xxx" id="student-id-input" class="validate">
          <span class="helper-text" data-error="Mauvais identifiant" data-success=""></span>
        </div>
        
        <div class="col s12 center-align">
          <input type="submit" id="submit-input" class="btn btn-large">
        </div>
      </form>
    </div>
  </main>

  
  <footer class="page-footer teal">
  
    <div class="footer-copyright">
      <div class="container">
        © 2018 Human'app
        <a class="grey-text text-lighten-4 right" href="#">More Links</a>
      </div>
    </div>
  </footer>

  
  <script type="text/javascript" src="./js/jquery.min.js"></script>
  <script type="text/javascript" src="./js/materialize.min.js"></script>
  
  <!-- Script that is executed only when the page is fully loaded -->
  <script type="text/javascript">
    // Initializing MaterializeJS
    M.AutoInit();
    
    // Initializing the default value to 20180000
    document.getElementById("student-id-input").value = 20180000;
    
    // Form verification (before sending)
    document.getElementById("submit-input").addEventListener("click", e => {
      if (!checkFirstName() || !checkLastName() || !checkStudentID()) {
        alert("Formulaire mal rempli");
        e.preventDefault();
      }
      
      M.toast({
        html: "<h6>Compte créé !</h6>",
        displayLength: 6000
      });
      
      window.location.replace("https://weigardium-challenge.human-app.fr/");
      e.preventDefault();
      e.stopPropagation();
    });
    
    
    // Weak student id verification
    checkStudentID = () => {
      let id = $("#student-id-input").val();
      
      id.trim();
      
      if (!id.startsWith("20180")) {
        setError("studentID");
        return false;
      }
      
      return id.length === 8;
    };
    
    // Very weak first name verification
    checkFirstName = () => {
      let firstName = $("#first-name-input").val();
      
      firstName.trim();
      
      if (firstName.length >= 2) {
        return true;
      } else {
        setError("firstName");
        return false;
      }
    };
    
    // Very weak last name verification
    checkLastName = () => {
      let lastName = $("#last-name-input").val();
      
      lastName.trim();
      
      if (lastName.length >= 2) {
        return true;
      } else {
        setError("lastName");
        return false;
      }
    };
    
    // To set errors faster
    setError = where => {
      if (where === "firstName") {
        $("#first-name-label").val("Erreur sur le prénom");
      }
      else if (where === "lastName") {
        $("#last-name-label").val("Erreur sur le nom de famille");
      }
      else if (where === "studentID") {
        $("#student-id-label").val("Erreur sur le numéro d'étudiant");
      }
    };
  </script>
</body>
</html>